{
    "openapi": "3.0.0",
    "info": {
        "description": "This is a REST API documentation for Risk Gap Targeting Service of Inovalon Inc., risk adjustment module for Medicare Advantage (CMS), commercial (HHS) or Chronic Illness and Disability Payment System (CDPS) patients based on machine learning algorithms. You can find out more about Inovalon at [https://www.inovalon.com/](https://www.inovalon.com).",
        "version": "2.6.0",
        "title": "RiskGapTargetingService",
        "contact": {
            "email": "ywang2@inovalon.com"
        }
    },
    "servers": [
        {
            "url": "/"
        }
    ],
    "paths": {
        "/": {
            "get": {
                "summary": "welcome index",
                "operationId": "index",
                "responses": {
                    "200": {
                        "description": "Successful response",
                        "content": {
                            "text/html": {
                                "example": "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 3.2 Final//EN\">\n<title>Risk Gap Targeting Service</title>\n<h2>Welcome to risk gap targeting Service !</h2>\n<p>Please POST your requests through /detect or /update with body as application/json. To try out API and view the documentation, please view /documentation.</p>"
                            }
                        }
                    }
                }
            }
        },
        "/detect": {
            "post": {
                "summary": "risk gap detection for both retrospective and prospective purpose with practitioner recommendation",
                "description": "Core pipeline of risk gap detection based on one patient's prior and current period of claims data and return documented conditions, gap conditions with confidence and corresponding supporting evidences with practitioner recommendations.",
                "operationId": "detect",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CoreData"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Result"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/BadRequestError"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/InternalError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/update": {
            "patch": {
                "summary": "train and add a model ML into server for one model version ID",
                "operationId": "update",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/TrainingData"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful."
                    },
                    "400": {
                        "description": "Bad request",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/BadRequestError"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/InternalError"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/delete/{modelVersionID}": {
            "delete": {
                "summary": "delete entire machine learning model of certain model_version_ID",
                "operationId": "delete",
                "parameters": [
                    {
                        "name": "modelVersionID",
                        "in": "path",
                        "description": "Model version ID to delete",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful."
                    },
                    "404": {
                        "description": "modelVersionID not found."
                    }
                }
            }
        }
    },
    "components": {
        "schemas": {
            "CoreData": {
                "type": "object",
                "required": [
                    "correlation_id",
                    "model_version_ID",
                    "payload"
                ],
                "properties": {
                    "correlation_id": {
                        "type": "string",
                        "example": "12345",
                        "description": "the ID of this call for developers debugging reference."
                    },
                    "today_date": {
                        "type": "string",
                        "example": "2020-04-15",
                        "description": "the date making this API call with format \"YYYY-MM-DD\"."
                    },
                    "target_year": {
                        "type": "integer",
                        "example": 2020,
                        "description": "an integer the target service year, all prior years' data will treated as historical data and data under target_year will be treated as current service year. If not provided, model will use the server sytem today's year."
                    },
                    "model_version_ID": {
                        "type": "integer",
                        "example": 63,
                        "description": "an integer of model version ID in Inovalon database MPBWDB1.CARA2_Controller.dbo.ModelVersions; note this package only support CDPS, CMS and HHS"
                    },
                    "threshold": {
                        "type": "number",
                        "example": 0.5,
                        "minimum": 0.0,
                        "maximum": 1.0,
                        "description": "the threhold of output confidence level (only return those suspected gaps with confidence greater than threshold)."
                    },
                    "get_indicators": {
                        "type": "boolean",
                        "example": true,
                        "description": "if true, return top n indicators of claim codes that contribute the most to the suspected, or return all ICD codes the directly indicating such HCCs. By defualt the parameter is true."
                    },
                    "top_indicators": {
                        "type": "integer",
                        "example": 5,
                        "description": "number of indicators to output for suspected gaps if get_indicators is true. By default the parameter is 5."
                    },
                    "payload": {
                        "type": "array",
                        "items": {
                            "type": "object",
                            "required": [
                                "mem_id",
                                "codes"
                            ],
                            "properties": {
                                "mem_id": {
                                    "type": "integer",
                                    "example": 100001,
                                    "description": "the ID of patient/member/beneficiary."
                                },
                                "codes": {
                                    "type": "array",
                                    "items": {
                                        "type": "object",
                                        "required": [
                                            "service_date",
                                            "code_type",
                                            "code"
                                        ],
                                        "properties": {
                                            "service_date": {
                                                "type": "string",
                                                "example": "2019-05-23",
                                                "description": "the service/encounter date of the corresponding claim code was documented."
                                            },
                                            "code_type": {
                                                "type": "string",
                                                "example": "ICD10DX",
                                                "description": "the claim type, only accept \"ICD9DX\", \"ICD10DX\", \"CPT\", \"HCPCS\", \"NDC9\", \"ICD9PX\", \"ICD10PX\" or \"DRG\"."
                                            },
                                            "code": {
                                                "type": "string",
                                                "example": "I10",
                                                "description": "the code under corresponding code type with all decimal removed."
                                            },
                                            "pra_id": {
                                                "type": "integer",
                                                "example": 234,
                                                "description": "the practitioner ID who reported this claim code."
                                            },
                                            "spec_id": {
                                                "type": "integer",
                                                "example": 87,
                                                "description": "the Inovalon specialist ID for this practitioner."
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                "example": {
                    "correlation_id": "12345",
                    "today_date": "2019-04-15",
                    "target_year": 2019,
                    "model_version_ID": 63,
                    "mode": "b",
                    "threshold": 0.3,
                    "get_indicators": true,
                    "top_n_indicator": 5,
                    "payload": [
                        {
                            "mem_id": 23023,
                            "codes": [
                                {
                                    "service_date": "2018-08-24",
                                    "code_type": "ICD10DX",
                                    "code": "J449",
                                    "provider_id": 505,
                                    "spec_id": 87
                                },
                                {
                                    "service_date": "2018-10-11",
                                    "code_type": "ICD10PX",
                                    "code": "0JB70ZZ",
                                    "provider_id": 505,
                                    "spec_id": 87
                                },
                                {
                                    "service_date": "2019-02-09",
                                    "code_type": "HCPCS",
                                    "code": "A0425",
                                    "provider_id": 24481,
                                    "spec_id": 12
                                },
                                {
                                    "service_date": "2019-02-21",
                                    "code_type": "CPT",
                                    "code": "99309",
                                    "provider_id": 2576568,
                                    "spec_id": 66
                                },
                                {
                                    "service_date": "2019-03-28",
                                    "code_type": "NDC9",
                                    "code": "004870201",
                                    "provider_id": 2576568,
                                    "spec_id": 66
                                },
                                {
                                    "service_date": "2018-09-28",
                                    "code_type": "ICD10DX",
                                    "code": "I214",
                                    "provider_id": 317793,
                                    "spec_id": 59
                                },
                                {
                                    "service_date": "2019-02-28",
                                    "code_type": "ICD10DX",
                                    "code": "E119",
                                    "provider_id": 492195,
                                    "spec_id": 210
                                }
                            ]
                        },
                        {
                            "mem_id": 51620,
                            "codes": [
                                {
                                    "service_date": "2019-02-19",
                                    "code_type": "ICD10DX",
                                    "code": "H8112",
                                    "provider_id": 80448,
                                    "spec_id": 157
                                },
                                {
                                    "service_date": "2018-04-18",
                                    "code_type": "HCPCS",
                                    "code": "E0747",
                                    "provider_id": 81628,
                                    "spec_id": 58
                                },
                                {
                                    "service_date": "2018-04-18",
                                    "code_type": "ICD10DX",
                                    "code": "S82846K",
                                    "provider_id": 81628,
                                    "spec_id": 58
                                },
                                {
                                    "service_date": "2018-01-01",
                                    "code_type": "HCPCS",
                                    "code": "S9325",
                                    "provider_id": 82584,
                                    "spec_id": 85
                                },
                                {
                                    "service_date": "2018-07-27",
                                    "code_type": "CPT",
                                    "code": "99221",
                                    "provider_id": 466581,
                                    "spec_id": 95
                                },
                                {
                                    "service_date": "2018-07-18",
                                    "code_type": "ICD10DX",
                                    "code": "M545",
                                    "provider_id": 2558344,
                                    "spec_id": 27
                                },
                                {
                                    "service_date": "2018-12-07",
                                    "code_type": "NDC9",
                                    "code": "651620698",
                                    "provider_id": 2576965,
                                    "spec_id": 66
                                },
                                {
                                    "service_date": "2018-10-25",
                                    "code_type": "ICD10DX",
                                    "code": "E119",
                                    "provider_id": 29061,
                                    "spec_id": 87
                                },
                                {
                                    "service_date": "2018-04-23",
                                    "code_type": "ICD10DX",
                                    "code": "D709",
                                    "provider_id": 22128,
                                    "spec_id": 87
                                },
                                {
                                    "service_date": "2018-01-01",
                                    "code_type": "ICD10DX",
                                    "code": "J156",
                                    "provider_id": 45060,
                                    "spec_id": 85
                                },
                                {
                                    "service_date": "2019-02-16",
                                    "code_type": "ICD10DX",
                                    "code": "J156",
                                    "provider_id": 45060,
                                    "spec_id": 85
                                }
                            ]
                        }
                    ]
                }
            },
            "TrainingData": {
                "type": "object",
                "required": [
                    "correlation_id",
                    "model_version_ID",
                    "payload"
                ],
                "properties": {
                    "correlation_id": {
                        "type": "string",
                        "example": "12345",
                        "description": "the ID of this call for developers debugging reference."
                    },
                    "model_version_ID": {
                        "type": "integer",
                        "example": 63,
                        "description": "an integer of model version ID in Inovalon database MPBWDB1.CARA2_Controller.dbo.ModelVersions; note this package only support CDPS, CMS and HHS"
                    },
                    "payload": {
                        "type": "object",
                        "required": [
                            "mapping",
                            "training_data"
                        ],
                        "properties": {
                            "mapping": {
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "properties": {
                                        "code_type": {
                                            "type": "string",
                                            "example": "ICD10DX",
                                            "description": "the claim type, only accept \"ICD9DX\", \"ICD10DX\", \"CPT\", \"HCPCS\", \"NDC9\", \"ICD9PX\", \"ICD10PX\" or \"DRG\"."
                                        },
                                        "code": {
                                            "type": "string",
                                            "example": "I10",
                                            "description": "the code under corresponding code type with all decimal removed."
                                        },
                                        "hcc": {
                                            "type": "array",
                                            "items": {
                                                "type": "string",
                                                "example": "HCC18",
                                                "description": "high-level CMS/HHS/CDPS defined conditions to be targeted."
                                            }
                                        }
                                    }
                                }
                            },
                            "training_data": {
                                "type": "array",
                                "description": "claim codes of each members in one historical service year as training data",
                                "items": {
                                    "type": "object",
                                    "required": [
                                        "mem_id",
                                        "codes"
                                    ],
                                    "properties": {
                                        "mem_id": {
                                            "type": "integer",
                                            "example": 100001,
                                            "description": "the ID of patient/member/beneficiary, can be fake IDs."
                                        },
                                        "codes": {
                                            "type": "array",
                                            "items": {
                                                "type": "object",
                                                "properties": {
                                                    "code_type": {
                                                        "type": "string",
                                                        "example": "ICD10DX",
                                                        "description": "the claim type, only accept \"ICD9DX\", \"ICD10DX\", \"CPT\", \"HCPCS\", \"NDC9\", \"ICD9PX\", \"ICD10PX\" or \"DRG\"."
                                                    },
                                                    "code": {
                                                        "type": "string",
                                                        "example": "I10",
                                                        "description": "the code under corresponding code type with all decimal removed."
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            },
            "Result": {
                "Request Status": "Success",
                "correlation_id": "12345",
                "model_version_ID": 63,
                "prospective": [
                    {
                        "gaps": [
                            {
                                "condition_category": "HCC86",
                                "confidence": 0.045032,
                                "known_current": 0,
                                "kown_historical": 1,
                                "top_indicators": [
                                    {
                                        "code": "I214",
                                        "code_type": "ICD10DX",
                                        "provider_id": [
                                            317793
                                        ]
                                    }
                                ]
                            },
                            {
                                "condition_category": "HCC19",
                                "confidence": 0.392743,
                                "known_current": 1,
                                "kown_historical": 0,
                                "top_indicators": [
                                    {
                                        "code": "E119",
                                        "code_type": "ICD10DX",
                                        "provider_id": [
                                            492195
                                        ]
                                    }
                                ]
                            },
                            {
                                "condition_category": "HCC79",
                                "confidence": 0.471811,
                                "known_current": 0,
                                "kown_historical": 0,
                                "top_indicators": [
                                    {
                                        "code": "A0425",
                                        "code_type": "HCPCS",
                                        "provider_id": []
                                    },
                                    {
                                        "code": "99309",
                                        "code_type": "CPT",
                                        "provider_id": [
                                            2576568
                                        ]
                                    }
                                ]
                            },
                            {
                                "condition_category": "HCC57",
                                "confidence": 0.53715,
                                "known_current": 0,
                                "kown_historical": 0,
                                "top_indicators": [
                                    {
                                        "code": "99309",
                                        "code_type": "CPT",
                                        "provider_id": [
                                            2576568
                                        ]
                                    },
                                    {
                                        "code": "A0425",
                                        "code_type": "HCPCS",
                                        "provider_id": []
                                    }
                                ]
                            },
                            {
                                "condition_category": "HCC55",
                                "confidence": 0.455976,
                                "known_current": 0,
                                "kown_historical": 0,
                                "top_indicators": [
                                    {
                                        "code": "A0425",
                                        "code_type": "HCPCS",
                                        "provider_id": []
                                    }
                                ]
                            },
                            {
                                "condition_category": "HCC111",
                                "confidence": 0.395838,
                                "known_current": 0,
                                "kown_historical": 1,
                                "top_indicators": [
                                    {
                                        "code": "J449",
                                        "code_type": "ICD10DX",
                                        "provider_id": [
                                            505
                                        ]
                                    }
                                ]
                            },
                            {
                                "condition_category": "HCC58",
                                "confidence": 0.572275,
                                "known_current": 0,
                                "kown_historical": 0,
                                "top_indicators": [
                                    {
                                        "code": "A0425",
                                        "code_type": "HCPCS",
                                        "provider_id": []
                                    },
                                    {
                                        "code": "99309",
                                        "code_type": "CPT",
                                        "provider_id": [
                                            2576568
                                        ]
                                    }
                                ]
                            }
                        ],
                        "mem_id": 23023
                    },
                    {
                        "gaps": [
                            {
                                "condition_category": "HCC19",
                                "confidence": 0.189366,
                                "known_current": 0,
                                "kown_historical": 1,
                                "top_indicators": [
                                    {
                                        "code": "E119",
                                        "code_type": "ICD10DX",
                                        "provider_id": [
                                            29061
                                        ]
                                    }
                                ]
                            },
                            {
                                "condition_category": "HCC47",
                                "confidence": 0.055095,
                                "known_current": 0,
                                "kown_historical": 1,
                                "top_indicators": [
                                    {
                                        "code": "D709",
                                        "code_type": "ICD10DX",
                                        "provider_id": [
                                            22128
                                        ]
                                    }
                                ]
                            },
                            {
                                "condition_category": "HCC114",
                                "confidence": 0.027371,
                                "known_current": 1,
                                "kown_historical": 1,
                                "top_indicators": [
                                    {
                                        "code": "J156",
                                        "code_type": "ICD10DX",
                                        "provider_id": []
                                    }
                                ]
                            }
                        ],
                        "mem_id": 51620
                    }
                ],
                "retrospective": [
                    {
                        "gaps": [
                            {
                                "condition_category": "HCC86",
                                "confidence": 0.013296,
                                "known": 1,
                                "top_indicators": [
                                    {
                                        "code": "I214",
                                        "code_type": "ICD10DX",
                                        "provider_id": [
                                            317793
                                        ]
                                    }
                                ]
                            },
                            {
                                "condition_category": "HCC111",
                                "confidence": 0.107791,
                                "known": 1,
                                "top_indicators": [
                                    {
                                        "code": "J449",
                                        "code_type": "ICD10DX",
                                        "provider_id": [
                                            505
                                        ]
                                    }
                                ]
                            }
                        ],
                        "mem_id": 23023
                    },
                    {
                        "gaps": [
                            {
                                "condition_category": "HCC19",
                                "confidence": 0.189366,
                                "known": 1,
                                "top_indicators": [
                                    {
                                        "code": "E119",
                                        "code_type": "ICD10DX",
                                        "provider_id": [
                                            29061
                                        ]
                                    }
                                ]
                            },
                            {
                                "condition_category": "HCC47",
                                "confidence": 0.055095,
                                "known": 1,
                                "top_indicators": [
                                    {
                                        "code": "D709",
                                        "code_type": "ICD10DX",
                                        "provider_id": [
                                            22128
                                        ]
                                    }
                                ]
                            },
                            {
                                "condition_category": "HCC114",
                                "confidence": 0.027371,
                                "known": 1,
                                "top_indicators": [
                                    {
                                        "code": "J156",
                                        "code_type": "ICD10DX",
                                        "provider_id": []
                                    }
                                ]
                            }
                        ],
                        "mem_id": 51620
                    }
                ],
                "target_year": 2019,
                "warnings": []
            },
            "BadRequestError": {
                "type": "object",
                "required": [
                    "Request Status",
                    "Error Message"
                ],
                "properties": {
                    "Request Status": {
                        "type": "string",
                        "example": "Failed"
                    },
                    "correlation_id": {
                        "type": "string",
                        "example": "12345",
                        "description": "the ID for client developers debugging reference"
                    },
                    "request_api": {
                        "type": "string",
                        "example": "CARAMLService"
                    },
                    "Error Message": {
                        "type": "string",
                        "example": {
                            "oneOf": [
                                "Bad request: either no input or not application/json type.",
                                "Bad request: no payload.",
                                "Bad request: \"model_version_ID\" 65 does not exist, please provide correct number or contact API admin."
                            ]
                        }
                    }
                }
            },
            "InternalError": {
                "type": "object",
                "properties": {
                    "Request Status": {
                        "type": "string",
                        "example": "Failed"
                    },
                    "correlation_id": {
                        "type": "string",
                        "example": "12345",
                        "description": "the ID for client developers debugging reference"
                    },
                    "request_api": {
                        "type": "string",
                        "example": "CARAMLService"
                    },
                    "Error": {
                        "type": "string",
                        "example": "NameError"
                    },
                    "Error Message": {
                        "type": "string",
                        "example": "name 'example' is not defined"
                    },
                    "stack_trace": {
                        "type": "string",
                        "example": "Traceback (most recent call last):\n  File \".\\app.py\", line 143, in retrospective\n    print(example)\nNameError: name 'example' is not defined\n",
                        "description": "traceback of internal Python error for debuggin purpose."
                    }
                }
            }
        }
    }
}